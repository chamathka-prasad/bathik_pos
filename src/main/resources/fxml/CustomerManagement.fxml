<?xml version="1.0" encoding="UTF-8"?>

<?import com.jfoenix.controls.JFXButton?>
<?import com.jfoenix.controls.JFXTextField?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.control.cell.PropertyValueFactory?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>

<BorderPane xmlns="http://javafx.com/javafx"
            xmlns:fx="http://javafx.com/fxml"
            fx:controller="com.chamathka.bathikpos.controller.CustomerManagementController"
            prefWidth="1100"
            prefHeight="650"
            style="-fx-background-color: #f5f5f5;">

    <!-- Top Bar -->
    <top>
        <HBox alignment="CENTER_LEFT" spacing="15" style="-fx-background-color: white; -fx-padding: 15 20;">
            <JFXButton text="â† Back to Dashboard"
                      onAction="#handleBackToDashboard"
                      style="-fx-background-color: #e0e7ff; -fx-text-fill: #4338ca; -fx-background-radius: 5;">
                <font>
                    <Font name="System Bold" size="12"/>
                </font>
            </JFXButton>

            <Region HBox.hgrow="ALWAYS"/>

            <Label text="Customer Management" textFill="#1f2937">
                <font>
                    <Font name="System Bold" size="20"/>
                </font>
            </Label>

            <Region HBox.hgrow="ALWAYS"/>

            <!-- Search Box -->
            <JFXTextField fx:id="searchField"
                         promptText="Search customers..."
                         prefWidth="250"
                         onKeyReleased="#handleSearch">
                <font>
                    <Font size="13"/>
                </font>
            </JFXTextField>

            <JFXButton text="+ Add Customer"
                      onAction="#handleAddCustomer"
                      style="-fx-background-color: #6366f1; -fx-text-fill: white; -fx-background-radius: 5;"
                      prefHeight="35">
                <font>
                    <Font name="System Bold" size="13"/>
                </font>
            </JFXButton>
        </HBox>
    </top>

    <!-- Center - Customer Table -->
    <center>
        <VBox spacing="10" style="-fx-padding: 20;">
            <TableView fx:id="customerTable" VBox.vgrow="ALWAYS">
                <columns>
                    <TableColumn text="ID" prefWidth="60">
                        <cellValueFactory>
                            <PropertyValueFactory property="customerId"/>
                        </cellValueFactory>
                    </TableColumn>

                    <TableColumn text="Name" prefWidth="220">
                        <cellValueFactory>
                            <PropertyValueFactory property="name"/>
                        </cellValueFactory>
                    </TableColumn>

                    <TableColumn text="Phone" prefWidth="150">
                        <cellValueFactory>
                            <PropertyValueFactory property="phoneNumber"/>
                        </cellValueFactory>
                    </TableColumn>

                    <TableColumn text="Email" prefWidth="200">
                        <cellValueFactory>
                            <PropertyValueFactory property="email"/>
                        </cellValueFactory>
                    </TableColumn>

                    <TableColumn text="Total Purchases" prefWidth="150">
                        <cellFactory>
                            <fx:reference source="purchasesCellFactory"/>
                        </cellFactory>
                    </TableColumn>

                    <TableColumn text="Visits" prefWidth="80" style="-fx-alignment: CENTER;">
                        <cellValueFactory>
                            <PropertyValueFactory property="visitCount"/>
                        </cellValueFactory>
                    </TableColumn>

                    <TableColumn text="Actions" prefWidth="140">
                        <cellFactory>
                            <fx:reference source="actionCellFactory"/>
                        </cellFactory>
                    </TableColumn>
                </columns>
            </TableView>

            <Label fx:id="statusLabel" textFill="#6b7280">
                <font>
                    <Font size="12"/>
                </font>
            </Label>
        </VBox>
    </center>

</BorderPane>
